# Python API Test Framework

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„Python APIè‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼Œæ”¯æŒæ•°æ®åº“é©±åŠ¨æµ‹è¯•ã€å¤šç¯å¢ƒé…ç½®ã€ä¸°å¯Œçš„æ–­è¨€åŠŸèƒ½å’ŒAllureæµ‹è¯•æŠ¥å‘Šã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- **æ•°æ®åº“é©±åŠ¨æµ‹è¯•**ï¼šæµ‹è¯•ç”¨ä¾‹å­˜å‚¨åœ¨PostgreSQLæ•°æ®åº“ä¸­ï¼Œæ”¯æŒåŠ¨æ€ç”Ÿæˆæµ‹è¯•
- **å¤šç¯å¢ƒæ”¯æŒ**ï¼šæ”¯æŒdevã€uatç­‰ä¸åŒç¯å¢ƒçš„é…ç½®ç®¡ç†
- **ä¸°å¯Œæ–­è¨€**ï¼šæ”¯æŒçŠ¶æ€ç ã€JSONè·¯å¾„ã€JSON Schemaç­‰å¤šç§æ–­è¨€ç±»å‹
- **å‚æ•°åŒ–æµ‹è¯•**ï¼šæ”¯æŒä»å“åº”ä¸­æå–å˜é‡å¹¶åœ¨åç»­æ­¥éª¤ä¸­ä½¿ç”¨
- **AllureæŠ¥å‘Š**ï¼šé›†æˆAllureæµ‹è¯•æŠ¥å‘Šï¼Œæä¾›è¯¦ç»†çš„æµ‹è¯•ç»“æœå±•ç¤º
- **çµæ´»ç­›é€‰**ï¼šæ”¯æŒæŒ‰ç»„ä»¶ã€æ ‡ç­¾ã€ç”¨ä¾‹IDç­‰æ¡ä»¶ç­›é€‰æµ‹è¯•ç”¨ä¾‹

## ğŸ“ é¡¹ç›®ç»“æ„

```
auto_test/
â”œâ”€â”€ api/                    # APIç›¸å…³æ¨¡å—
â”œâ”€â”€ configs/               # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.yaml       # ä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ logging_config.yaml # æ—¥å¿—é…ç½®
â”œâ”€â”€ core/                  # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ api_client.py     # APIå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ assertion_engine.py # æ–­è¨€å¼•æ“
â”‚   â”œâ”€â”€ context_manager.py # ä¸Šä¸‹æ–‡ç®¡ç†å™¨
â”‚   â””â”€â”€ db_handler.py     # æ•°æ®åº“å¤„ç†å™¨
â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ tables.py        # æ•°æ®åº“è¡¨ç»“æ„
â”œâ”€â”€ tests/               # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ conftest.py     # pytesté…ç½®
â”‚   â””â”€â”€ test_main.py    # ä¸»æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ utils/               # å·¥å…·æ¨¡å—
â”‚   â””â”€â”€ placeholder_parser.py # å ä½ç¬¦è§£æå™¨
â”œâ”€â”€ logs/                # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ reports/             # æµ‹è¯•æŠ¥å‘Š
â”œâ”€â”€ requirements.txt     # ä¾èµ–åŒ…
â”œâ”€â”€ run.py              # æµ‹è¯•è¿è¡Œå™¨
â””â”€â”€ README.md           # é¡¹ç›®è¯´æ˜
```

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- PostgreSQL æ•°æ®åº“
- Allure å‘½ä»¤è¡Œå·¥å…·

### å®‰è£…ä¾èµ–

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# æˆ–
.venv\Scripts\activate     # Windows

# å®‰è£…ä¾èµ–åŒ…
pip install -r requirements.txt
```

### é…ç½®ç¯å¢ƒ

1. å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿ï¼š
```bash
cp env.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ï¼š
```env
DB_PASSWORD=your_database_password
DB_HOST=localhost
DB_PORT=5432
DB_NAME=autotest
DB_USER=admin
```

3. é…ç½® `configs/config.yaml`ï¼š
```yaml
default:
  db_host: "localhost"
  db_port: 5432
  db_user: "admin"

uat:
  base_url: "http://127.0.0.1:8787"
  db_name: "autotest"
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python run.py --env uat

# æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
allure open reports/allure-report
```

## ğŸ“Š æ”¯æŒçš„æ–­è¨€ç±»å‹

- `status_code_equals`: çŠ¶æ€ç ç­‰äºæŒ‡å®šå€¼
- `json_path_equals`: JSONè·¯å¾„çš„å€¼ç­‰äºæŒ‡å®šå€¼
- `json_path_exists`: JSONè·¯å¾„å­˜åœ¨
- `contains_text`: å“åº”ä½“åŒ…å«æŒ‡å®šæ–‡æœ¬
- `header_equals`: å“åº”å¤´ç­‰äºæŒ‡å®šå€¼

## ğŸ”§ é…ç½®è¯´æ˜

### æ•°æ®åº“è¡¨ç»“æ„

- `test_environments`: æµ‹è¯•ç¯å¢ƒé…ç½®
- `test_cases`: æµ‹è¯•ç”¨ä¾‹
- `test_steps`: æµ‹è¯•æ­¥éª¤
- `test_assertions`: æ–­è¨€è§„åˆ™
- `test_step_outputs`: è¾“å‡ºå˜é‡è§„åˆ™

### ç¯å¢ƒé…ç½®

æ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼Œå¯åœ¨ `configs/config.yaml` ä¸­å®šä¹‰ä¸åŒç¯å¢ƒçš„å‚æ•°ã€‚

## ğŸ“ˆ æµ‹è¯•æŠ¥å‘Š

æ¡†æ¶é›†æˆAllureæµ‹è¯•æŠ¥å‘Šï¼Œæä¾›ï¼š
- è¯¦ç»†çš„æµ‹è¯•æ‰§è¡Œæ­¥éª¤
- è¯·æ±‚å’Œå“åº”ä¿¡æ¯
- æ–­è¨€ç»“æœ
- å¤±è´¥åŸå› åˆ†æ
- ç¾è§‚çš„HTMLç•Œé¢

